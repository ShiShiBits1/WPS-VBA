# 原料入库验收单自动打印系统

## 概述

本系统是一个基于WPS宏的自动化工具，用于简化水产品加工企业的原料入库验收流程。通过自动从入库记录中提取数据并填充到标准验收单模板，系统能够大幅减少人工操作，提高工作效率和数据准确性。

## 功能特性

- ✅ 自动从"入库记录"工作表提取数据
- ✅ 智能填充验收单模板中的供应商、品名、重量和日期信息
- ✅ 每次打印两个验收单，完美适配A4纸张
- ✅ 支持批量处理，自动循环所有入库记录
- ✅ 打印间隔控制，防止打印机过载
- ✅ 简洁的用户界面，一键操作

## 安装与使用

### 前提条件

- WPS Office (2016或更高版本)
- 启用宏功能(工具 \> 选项 \> 信任中心 \> 宏安全 \> 启用所有宏)

### 安装步骤

1. 下载或复制提供的VBA代码
2. 打开包含"入库记录"和"验收单模板"的Excel文件
3. 按Alt+F11打开VBA编辑器
4. 插入新模块，粘贴提供的代码
5. 保存文件为启用宏的格式(.xlsm)

### 使用方法

1. 确保"入库记录"工作表中包含正确的入库数据
2. 确保"验收单模板"工作表格式正确
3. 在WPS中按Alt+F8打开宏对话框
4. 选择"自动填充验收单并打印"宏
5. 点击"运行"开始处理

## 文件结构

text

```
原料入库验收系统.xlsm
├── 入库记录工作表
│   ├── 日期列(A)
│   ├── 供应商列(B)
│   ├── 品名列(C)
│   └── 重量列(D)
└── 验收单模板工作表
    ├── 上半部分验收单(行1-13)
    └── 下半部分验收单(行14-26)
```

## 自定义配置

如需调整打印设置，可修改代码中的页面设置部分：

vba

```
'设置打印方向（纵向）
验收单模板.PageSetup.Orientation = xlPortrait

'设置居中打印
验收单模板.PageSetup.CenterHorizontally = True

'设置页边距
验收单模板.PageSetup.LeftMargin = Application.InchesToPoints(0.5)
验收单模板.PageSetup.RightMargin = Application.InchesToPoints(0.5)
```

## 故障排除

### 常见问题

1. **宏无法运行**

    - 检查WPS宏安全设置是否已启用宏
    - 确保文件已保存为启用宏的格式(.xlsm)
2. **打印格式不正确**

    - 检查打印机纸张设置是否为A4
    - 确认验收单模板格式未被修改
3. **数据填充错误**

    - 确认"12月入库记录"工作表的列顺序正确
    - 检查日期格式是否为标准日期格式

### 获取帮助

如遇到问题，请检查：

1. WPS版本是否支持VBA宏
2. 工作表名称是否与代码中的名称一致
3. 入库记录数据格式是否正确

## 更新日志

### v1.0 (2025-08-26)

- 初始版本发布
- 实现基本数据提取和填充功能
- 添加批量打印功能

## 贡献

欢迎提交问题反馈和改进建议。如需贡献代码，请遵循以下步骤：

1. Fork本项目
2. 创建特性分支
3. 提交更改
4. 推送到分支
5. 创建Pull Request

## 许可证

本项目采用MIT许可证。详见LICENSE文件。

## 联系方式

如有问题或建议，请联系系统管理员或提交GitHub Issue。

---

**注意**: 使用前请确保备份原始数据文件，以防意外数据丢失。
